spring:
  application:
    name: sharegym-server

  # 데이터베이스 설정 (로컬 개발 - Docker MySQL)
  datasource:
    url: jdbc:mysql://${DB_HOST:localhost}:${DB_PORT:3306}/${DB_NAME:sharefitdb}?useSSL=false&serverTimezone=Asia/Seoul&characterEncoding=UTF-8&allowPublicKeyRetrieval=true
    username: ${DB_USERNAME:sharegym}
    password: ${DB_PASSWORD:sharegym123!}
    driver-class-name: com.mysql.cj.jdbc.Driver
    hikari:
      connection-timeout: 30000
      maximum-pool-size: 10

  # JPA 설정
  jpa:
    hibernate:
      ddl-auto: update  # 로컬: update (자동 테이블 생성/수정)
    properties:
      hibernate:
        format_sql: true
        show_sql: true  # 로컬: SQL 로그 표시
        dialect: org.hibernate.dialect.MySQLDialect
        default_batch_fetch_size: 100
    open-in-view: false

  # Redis 설정 (로컬 개발 - Docker 컨테이너)
  data:
    redis:
      host: ${REDIS_HOST:localhost}  # 로컬 Docker 컨테이너
      port: ${REDIS_PORT:6379}
      password: ${REDIS_PASSWORD:}
      timeout: 2000ms
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 0

  # 파일 업로드 설정
  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 10MB

  # 프로파일 설정 (기본값 제거 - IDE나 환경변수로 설정)
  web:
    error:
      include-message: always
      include-binding-errors: always

# 서버 설정
server:
  port: 8080
  servlet:
    context-path: /api/v1  # 로컬 개발용 경로

# JWT 설정 (로컬 개발)
jwt:
  secret: ${JWT_SECRET:local-development-secret-key-for-testing-only-not-for-production-use-32bytes!!}
  expiration: ${JWT_EXPIRATION:86400000} # 24시간 (밀리초)
  refresh-expiration: ${JWT_REFRESH_EXPIRATION:604800000} # 7일 (밀리초)

# AWS S3 설정 (로컬 개발)
aws:
  s3:
    bucket: ${S3_BUCKET_NAME:sharefit-bucket}
    region: ${S3_REGION:ap-northeast-2}
    access-key: ${AWS_ACCESS_KEY_ID}  # AWS CLI credentials 또는 환경변수
    secret-key: ${AWS_SECRET_ACCESS_KEY}  # AWS CLI credentials 또는 환경변수
    endpoint-url: https://s3.${S3_REGION:ap-northeast-2}.amazonaws.com
    folder-prefix: ${S3_FOLDER_PREFIX:local/}  # 로컬 개발용 폴더

# Firebase 설정 (FCM Push)
firebase:
  config-path: ${FIREBASE_CONFIG_PATH:classpath:firebase-service-account.json}

# CORS 설정 (로컬 개발)
cors:
  allowed-origins: http://localhost:3000,http://localhost:8081,http://10.50.26.144:8081,http://10.50.26.245:8081,http://10.50.26.144:3000,http://10.50.26.245:3000,http://10.50.26.144,http://10.50.26.245
  allowed-methods: GET,POST,PUT,DELETE,OPTIONS,PATCH
  allowed-headers: Authorization,Content-Type,X-Requested-With,Accept,Origin,Access-Control-Request-Method,Access-Control-Request-Headers
  exposed-headers: Authorization,Content-Type
  allow-credentials: true
  max-age: 3600

# Actuator 설정 (모니터링)
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: always

# Logging 설정 (로컬 개발)
logging:
  level:
    root: INFO
    com.sharegym.sharegym_server: DEBUG
    org.springframework.web: DEBUG
    org.springframework.security: DEBUG
    org.hibernate.SQL: DEBUG # SQL 로그 표시
    org.hibernate.type: TRACE # 파라미터 로그 표시
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
  file:
    name: logs/sharegym.log
    max-size: 10MB
    max-history: 30

# Springdoc OpenAPI 설정 (Swagger)
springdoc:
  api-docs:
    path: /api-docs  # /api/v1/api-docs로 접근
  swagger-ui:
    path: /swagger-ui.html  # /api/v1/swagger-ui.html로 접근
    tags-sorter: alpha
    operations-sorter: alpha
  default-consumes-media-type: application/json
  default-produces-media-type: application/json
